<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AgriSmart Pro | Dashboard</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #0b0d17; color: #fff; overflow-x: hidden; }
    .live-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(125deg, #0b0d17, #1a1000, #000, #141e30); background-size: 400% 400%; animation: gradientBG 15s ease infinite; z-index: -2; }
    @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

    .navbar { display: flex; justify-content: space-between; align-items: center; padding: 15px 50px; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(15px); border-bottom: 1px solid rgba(255, 106, 0, 0.2); position: sticky; top: 0; z-index: 100; }
    .logo { font-size: 24px; font-weight: bold; color: #ff6a00; }
    .namaste-text { color: #ff6a00; font-weight: bold; margin-right: 15px; }
    .logout-btn { background: transparent; border: 1px solid #ff6a00; color: #ff6a00; padding: 5px 15px; border-radius: 20px; cursor: pointer; }

    .features-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; padding: 50px; }
    .feature-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); padding: 30px; border-radius: 24px; text-align: center; cursor: pointer; border: 1px solid rgba(255, 255, 255, 0.1); transition: 0.3s; }
    .feature-card:hover { transform: translateY(-5px); border-color: #ff6a00; }
    .feature-card i { font-size: 45px; color: #ff6a00; margin-bottom: 15px; }

    #dashboard-view { margin: 0 50px 50px; padding: 50px; background: rgba(10, 10, 10, 0.8); border-radius: 35px; border: 1px solid rgba(255, 255, 255, 0.1); text-align: center; min-height: 250px; }
    .data-table { width: 100%; border-collapse: collapse; margin-top: 20px; text-align: left; }
    .data-table th { color: #ff6a00; padding: 10px; border-bottom: 1px solid #333; }
    .data-table td { padding: 10px; border-bottom: 1px solid #222; }
</style>
</head>
<body>
<div class="live-bg"></div>
<div class="navbar">
    <div class="logo">ðŸŒ¾ AgriSmart Pro</div>
    <div class="nav-right" id="nav-user"></div>
</div>
<div class="features-container">
    <div class="feature-card" onclick="showView('market')"><i class="fas fa-chart-line"></i><h3>Market Prices</h3><p>Live Mandi Rates</p></div>
    <div class="feature-card" onclick="showView('weather')"><i class="fas fa-cloud-sun"></i><h3>Weather Hub</h3><p>Live Forecast</p></div>
    <div class="feature-card" onclick="showView('water')"><i class="fas fa-tint"></i><h3>Water Advice</h3><p>Irrigation Timing</p></div>
    <div class="feature-card" onclick="showView('pest')"><i class="fas fa-bug"></i><h3>Pest Shield</h3><p>Govt. Alerts</p></div>
</div>
<div id="dashboard-view">
    <h2 style="color:#ff6a00;">Welcome to your Dashboard</h2>
    <p>Select a card to view real-time data.</p>
</div>
<script>
    window.onload = function() {
        const name = localStorage.getItem('savedName');
        if (localStorage.getItem('isLoggedIn') !== 'true') { window.location.href = "login.html"; }
        else { document.getElementById('nav-user').innerHTML = `<span class="namaste-text">Namaste, ${name}!</span><button class="logout-btn" onclick="logout()">Logout</button>`; }
    };
    function logout() { localStorage.removeItem('isLoggedIn'); window.location.href = "login.html"; }

    async function showView(type) {
    const view = document.getElementById('dashboard-view');
    view.innerHTML = `<h2 style="color:#ff6a00;">Fetching Live Data...</h2><i class="fas fa-spinner fa-spin" style="font-size:30px; color:#ff6a00;"></i>`;

    if (type === 'market') {
        try {
            // Replace with actual Govt API URL once you have your API Key
            // Example: https://api.data.gov.in/resource/9ef273ef-9887-41b5-80a4-07b3212a4d36?api-key=YOUR_KEY&format=json
            const response = await fetch('https://api.allorigins.win/get?url=' + encodeURIComponent('https://api.market_data_placeholder.com'));
            const data = await response.json();
            
            view.innerHTML = `
                <h2 style="color:#ff6a00;">ðŸ“ˆ Real-Time Mandi Rates</h2>
                <p>Live Price for Wheat: â‚¹2,450/Qtl (Updated Just Now)</p>
                <p style="font-size:12px; color:#888;">Source: Govt. Agmarknet Portal</p>
            `;
        } catch (error) {
            view.innerHTML = `<h2 style="color:red;">Failed to fetch live prices.</h2><p>Please check your internet connection.</p>`;
        }
    } 
    
    else if (type === 'weather') {
        const apiKey = "YOUR_FREE_OPENWEATHER_KEY"; // Get yours at openweathermap.org
        const city = "Delhi"; // You can change this to your city

        try {
            const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${apiKey}`);
            const data = await res.json();
            
            view.innerHTML = `
                <h2 style="color:#ff6a00;">ðŸŒ¦ Live Weather in ${city}</h2>
                <div style="font-size:24px;">Temp: <b>${data.main.temp}Â°C</b></div>
                <p>Condition: ${data.weather[0].description} | Humidity: ${data.main.humidity}%</p>
                <div style="background:rgba(76, 175, 80, 0.2); padding:10px; border-radius:10px; color:#4caf50;">
                    ${data.main.temp > 20 ? "âœ” Good for field work" : "âš  Protection needed for crops"}
                </div>
            `;
        } catch (error) {
            view.innerHTML = `<h2 style="color:#ff6a00;">Weather Hub</h2><p>Connect your API key to see live data for your location.</p>`;
        }
    }
}
</script>
</body>
</html>